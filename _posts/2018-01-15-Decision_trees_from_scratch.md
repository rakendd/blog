---
keywords: fastai
description: Python algorithm built from the scratch for a simple Decision Tree.
title: Decision Tree from the Scratch
toc: true 
badges: true
comments: true
categories: [machine learning]
image: images/decision_tree.png
nb_path: _notebooks/2018-01-15-Decision_trees_from_scratch.ipynb
layout: notebook
---

<!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2018-01-15-Decision_trees_from_scratch.ipynb
-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Python algorithm built from the scratch for a simple Decision Tree.</p>
<p>Theory and Math behind this post is covered <a href="https://medium.com/@rakendd/building-decision-trees-and-its-math-711862eea1c0">here</a> in Medium post.</p>
<p>We have just looked at Mathematical working for ID3, this post we will see how to build this in Python from the scratch. We will make it simple by using Pandas dataframes.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Load-the-prerequisites">Load the prerequisites<a class="anchor-link" href="#Load-the-prerequisites"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">eps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">eps</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">log2</span> <span class="k">as</span> <span class="n">log</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>‘eps’ here is the smallest representable number. At times we get log(0) or 0 in the denominator, to avoid that we are going to use this.</p>
<p>The dataset is very small one, we’ll just represent that with a dictionary.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Taste&#39;</span><span class="p">:[</span><span class="s1">&#39;Salty&#39;</span><span class="p">,</span><span class="s1">&#39;Spicy&#39;</span><span class="p">,</span><span class="s1">&#39;Spicy&#39;</span><span class="p">,</span><span class="s1">&#39;Spicy&#39;</span><span class="p">,</span><span class="s1">&#39;Spicy&#39;</span><span class="p">,</span><span class="s1">&#39;Sweet&#39;</span><span class="p">,</span><span class="s1">&#39;Salty&#39;</span><span class="p">,</span><span class="s1">&#39;Sweet&#39;</span><span class="p">,</span><span class="s1">&#39;Spicy&#39;</span><span class="p">,</span><span class="s1">&#39;Salty&#39;</span><span class="p">],</span>
       <span class="s1">&#39;Temperature&#39;</span><span class="p">:[</span><span class="s1">&#39;Hot&#39;</span><span class="p">,</span><span class="s1">&#39;Hot&#39;</span><span class="p">,</span><span class="s1">&#39;Hot&#39;</span><span class="p">,</span><span class="s1">&#39;Cold&#39;</span><span class="p">,</span><span class="s1">&#39;Hot&#39;</span><span class="p">,</span><span class="s1">&#39;Cold&#39;</span><span class="p">,</span><span class="s1">&#39;Cold&#39;</span><span class="p">,</span><span class="s1">&#39;Hot&#39;</span><span class="p">,</span><span class="s1">&#39;Cold&#39;</span><span class="p">,</span><span class="s1">&#39;Hot&#39;</span><span class="p">],</span>
       <span class="s1">&#39;Texture&#39;</span><span class="p">:[</span><span class="s1">&#39;Soft&#39;</span><span class="p">,</span><span class="s1">&#39;Soft&#39;</span><span class="p">,</span><span class="s1">&#39;Hard&#39;</span><span class="p">,</span><span class="s1">&#39;Hard&#39;</span><span class="p">,</span><span class="s1">&#39;Hard&#39;</span><span class="p">,</span><span class="s1">&#39;Soft&#39;</span><span class="p">,</span><span class="s1">&#39;Soft&#39;</span><span class="p">,</span><span class="s1">&#39;Soft&#39;</span><span class="p">,</span><span class="s1">&#39;Soft&#39;</span><span class="p">,</span><span class="s1">&#39;Hard&#39;</span><span class="p">],</span>
       <span class="s1">&#39;Eat&#39;</span><span class="p">:[</span><span class="s1">&#39;No&#39;</span><span class="p">,</span><span class="s1">&#39;No&#39;</span><span class="p">,</span><span class="s1">&#39;Yes&#39;</span><span class="p">,</span><span class="s1">&#39;No&#39;</span><span class="p">,</span><span class="s1">&#39;Yes&#39;</span><span class="p">,</span><span class="s1">&#39;Yes&#39;</span><span class="p">,</span><span class="s1">&#39;No&#39;</span><span class="p">,</span><span class="s1">&#39;Yes&#39;</span><span class="p">,</span><span class="s1">&#39;Yes&#39;</span><span class="p">,</span><span class="s1">&#39;Yes&#39;</span><span class="p">]}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We will read this with Pandas dataframe</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Taste&#39;</span><span class="p">,</span><span class="s1">&#39;Temperature&#39;</span><span class="p">,</span><span class="s1">&#39;Texture&#39;</span><span class="p">,</span><span class="s1">&#39;Eat&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Taste</th>
      <th>Temperature</th>
      <th>Texture</th>
      <th>Eat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Salty</td>
      <td>Hot</td>
      <td>Soft</td>
      <td>No</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Spicy</td>
      <td>Hot</td>
      <td>Soft</td>
      <td>No</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Spicy</td>
      <td>Hot</td>
      <td>Hard</td>
      <td>Yes</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Spicy</td>
      <td>Cold</td>
      <td>Hard</td>
      <td>No</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Spicy</td>
      <td>Hot</td>
      <td>Hard</td>
      <td>Yes</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Sweet</td>
      <td>Cold</td>
      <td>Soft</td>
      <td>Yes</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Salty</td>
      <td>Cold</td>
      <td>Soft</td>
      <td>No</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Sweet</td>
      <td>Hot</td>
      <td>Soft</td>
      <td>Yes</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Spicy</td>
      <td>Cold</td>
      <td>Soft</td>
      <td>Yes</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Salty</td>
      <td>Hot</td>
      <td>Hard</td>
      <td>Yes</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We have seen from an earlier post we need to find the Entropy and then Information Gain for splitting the data set.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>$S = - \sum\limits_{i=1}^N p_i log_2 p_i$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here the fraction is $p_i$, it is the proportion of a number of elements in that split group to the number of elements in the group before splitting(parent group).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We’ll define a function that takes in class (target variable vector) and finds the entropy of that class.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">entropy_node</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1">#Initialize Entropy</span>
<span class="n">values</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Eat</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>  <span class="c1">#Unique objects - &#39;Yes&#39;, &#39;No&#39;</span>
<span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
    <span class="n">fraction</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Eat</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()[</span><span class="n">value</span><span class="p">]</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Eat</span><span class="p">)</span>  
    <span class="n">entropy_node</span> <span class="o">+=</span> <span class="o">-</span><span class="n">fraction</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">fraction</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Summation is taken care of by ‘entropy +=’</p>
<p>We can check this by supplying our data frame to this function</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">entropy_node</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.9709505944546686</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is same as the entropy $(E_o)$ we calculated in the <a href="https://medium.com/@rakendd/building-decision-trees-and-its-math-711862eea1c0">theory post</a>. Now the entropy of the attribute Taste</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">attribute</span> <span class="o">=</span> <span class="s1">&#39;Taste&#39;</span>
<span class="n">target_variables</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Eat</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>  <span class="c1">#This gives all &#39;Yes&#39; and &#39;No&#39;</span>
<span class="n">variables</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">attribute</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>    <span class="c1">#This gives different features in that attribute (like &#39;Sweet&#39;)</span>
<span class="n">entropy_attribute</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">variable</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">:</span>
    <span class="n">entropy_each_feature</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">target_variable</span> <span class="ow">in</span> <span class="n">target_variables</span><span class="p">:</span>
        <span class="n">num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">attribute</span><span class="p">][</span><span class="n">df</span><span class="p">[</span><span class="n">attribute</span><span class="p">]</span><span class="o">==</span><span class="n">variable</span><span class="p">][</span><span class="n">df</span><span class="o">.</span><span class="n">Eat</span> <span class="o">==</span><span class="n">target_variable</span><span class="p">])</span> <span class="c1">#numerator</span>
        <span class="n">den</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">attribute</span><span class="p">][</span><span class="n">df</span><span class="p">[</span><span class="n">attribute</span><span class="p">]</span><span class="o">==</span><span class="n">variable</span><span class="p">])</span>  <span class="c1">#denominator</span>
        <span class="n">fraction</span> <span class="o">=</span> <span class="n">num</span><span class="o">/</span><span class="p">(</span><span class="n">den</span><span class="o">+</span><span class="n">eps</span><span class="p">)</span>  <span class="c1">#pi</span>
        <span class="n">entropy_each_feature</span> <span class="o">+=</span> <span class="o">-</span><span class="n">fraction</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">fraction</span><span class="o">+</span><span class="n">eps</span><span class="p">)</span> <span class="c1">#This calculates entropy for one feature like &#39;Sweet&#39;</span>
    <span class="n">fraction2</span> <span class="o">=</span> <span class="n">den</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">entropy_attribute</span> <span class="o">+=</span> <span class="o">-</span><span class="n">fraction2</span><span class="o">*</span><span class="n">entropy_each_feature</span>   <span class="c1">#Sums up all the entropy ETaste</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">abs</span><span class="p">(</span><span class="n">entropy_attribute</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.7609640474436806</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is same as the entropy $E_{Taste}$ we calculated in the <a href="https://medium.com/@rakendd/building-decision-trees-and-its-math-711862eea1c0">theory post</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now the Information Gain is simply</p>
<p>$IG_{Taste} = entropy_{node} — entropy_{attribute} = 0.21$</p>
<p>We will continue this for the other attributes ‘Temperature’ and ‘Texture’.</p>
<p>We just need to replace attribute= ‘Taste’ with ‘Temperature’ and ‘Texture’</p>
<p>We get,</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>$E_{Temperature} = 0.9509$</p>
<p>$E_{Texture} = 0.9245$</p>
<p>Then Information Gain,</p>
<p>$IG_{Temperature} = 0.02$</p>
<p>$IG_{Texture} = 0.05$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next process:</p>
<p>We’ll find the winner node, the one with the highest Information Gain. We repeat this process to find which is the attribute we need to consider to split the data at the nodes.</p>
<p>We build a decision tree based on this. Below is the complete code.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">find_entropy</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">Class</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>   <span class="c1">#To make the code generic, changing target variable class name</span>
    <span class="n">entropy</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">Class</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
        <span class="n">fraction</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">Class</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()[</span><span class="n">value</span><span class="p">]</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">Class</span><span class="p">])</span>
        <span class="n">entropy</span> <span class="o">+=</span> <span class="o">-</span><span class="n">fraction</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">fraction</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">entropy</span>
  
  
<span class="k">def</span> <span class="nf">find_entropy_attribute</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="n">attribute</span><span class="p">):</span>
  <span class="n">Class</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>   <span class="c1">#To make the code generic, changing target variable class name</span>
  <span class="n">target_variables</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">Class</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>  <span class="c1">#This gives all &#39;Yes&#39; and &#39;No&#39;</span>
  <span class="n">variables</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">attribute</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>    <span class="c1">#This gives different features in that attribute (like &#39;Hot&#39;,&#39;Cold&#39; in Temperature)</span>
  <span class="n">entropy2</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">for</span> <span class="n">variable</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">:</span>
      <span class="n">entropy</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="k">for</span> <span class="n">target_variable</span> <span class="ow">in</span> <span class="n">target_variables</span><span class="p">:</span>
          <span class="n">num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">attribute</span><span class="p">][</span><span class="n">df</span><span class="p">[</span><span class="n">attribute</span><span class="p">]</span><span class="o">==</span><span class="n">variable</span><span class="p">][</span><span class="n">df</span><span class="p">[</span><span class="n">Class</span><span class="p">]</span> <span class="o">==</span><span class="n">target_variable</span><span class="p">])</span>
          <span class="n">den</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">attribute</span><span class="p">][</span><span class="n">df</span><span class="p">[</span><span class="n">attribute</span><span class="p">]</span><span class="o">==</span><span class="n">variable</span><span class="p">])</span>
          <span class="n">fraction</span> <span class="o">=</span> <span class="n">num</span><span class="o">/</span><span class="p">(</span><span class="n">den</span><span class="o">+</span><span class="n">eps</span><span class="p">)</span>
          <span class="n">entropy</span> <span class="o">+=</span> <span class="o">-</span><span class="n">fraction</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">fraction</span><span class="o">+</span><span class="n">eps</span><span class="p">)</span>
      <span class="n">fraction2</span> <span class="o">=</span> <span class="n">den</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
      <span class="n">entropy2</span> <span class="o">+=</span> <span class="o">-</span><span class="n">fraction2</span><span class="o">*</span><span class="n">entropy</span>
  <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">entropy2</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">find_winner</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">Entropy_att</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">IG</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">keys</span><span class="p">()[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
<span class="c1">#         Entropy_att.append(find_entropy_attribute(df,key))</span>
        <span class="n">IG</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">find_entropy</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">-</span><span class="n">find_entropy_attribute</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="n">key</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">keys</span><span class="p">()[:</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">IG</span><span class="p">)]</span>
  
  
<span class="k">def</span> <span class="nf">get_subtable</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">==</span> <span class="n">value</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">buildTree</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="n">tree</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span> 
    <span class="n">Class</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>   <span class="c1">#To make the code generic, changing target variable class name</span>
    
    <span class="c1">#Here we build our decision tree</span>

    <span class="c1">#Get attribute with maximum information gain</span>
    <span class="n">node</span> <span class="o">=</span> <span class="n">find_winner</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    
    <span class="c1">#Get distinct value of that attribute e.g Salary is node and Low,Med and High are values</span>
    <span class="n">attValue</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">node</span><span class="p">])</span>
    
    <span class="c1">#Create an empty dictionary to create tree    </span>
    <span class="k">if</span> <span class="n">tree</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>                    
        <span class="n">tree</span><span class="o">=</span><span class="p">{}</span>
        <span class="n">tree</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    
   <span class="c1">#We make loop to construct a tree by calling this function recursively. </span>
    <span class="c1">#In this we check if the subset is pure and stops if it is pure. </span>

    <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">attValue</span><span class="p">:</span>
        
        <span class="n">subtable</span> <span class="o">=</span> <span class="n">get_subtable</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="n">node</span><span class="p">,</span><span class="n">value</span><span class="p">)</span>
        <span class="n">clValue</span><span class="p">,</span><span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">subtable</span><span class="p">[</span><span class="s1">&#39;Eat&#39;</span><span class="p">],</span><span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>                        
        
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span><span class="c1">#Checking purity of subset</span>
            <span class="n">tree</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="n">value</span><span class="p">]</span> <span class="o">=</span> <span class="n">clValue</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>                                                    
        <span class="k">else</span><span class="p">:</span>        
            <span class="n">tree</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="n">value</span><span class="p">]</span> <span class="o">=</span> <span class="n">buildTree</span><span class="p">(</span><span class="n">subtable</span><span class="p">)</span> <span class="c1">#Calling the function recursively </span>
                   
    <span class="k">return</span> <span class="n">tree</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we call the buildTree function and print the tree we built.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tree</span> <span class="o">=</span> <span class="n">buildTree</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pprint</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>{&#39;Taste&#39;: {&#39;Salty&#39;: {&#39;Texture&#39;: {&#39;Hard&#39;: &#39;Yes&#39;, &#39;Soft&#39;: &#39;No&#39;}},
           &#39;Spicy&#39;: {&#39;Temperature&#39;: {&#39;Cold&#39;: {&#39;Texture&#39;: {&#39;Hard&#39;: &#39;No&#39;,
                                                          &#39;Soft&#39;: &#39;Yes&#39;}},
                                     &#39;Hot&#39;: {&#39;Texture&#39;: {&#39;Hard&#39;: &#39;Yes&#39;,
                                                         &#39;Soft&#39;: &#39;No&#39;}}}},
           &#39;Sweet&#39;: &#39;Yes&#39;}}
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can see the tree structure is formed based on the priority list to split the data.</p>
<p>We can write an algorithm to predict using this tree structure.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="n">inst</span><span class="p">,</span><span class="n">tree</span><span class="p">):</span>
    <span class="c1">#This function is used to predict for any input variable </span>
    
    <span class="c1">#Recursively we go through the tree that we built earlier</span>

    <span class="k">for</span> <span class="n">nodes</span> <span class="ow">in</span> <span class="n">tree</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>        
        
        <span class="n">value</span> <span class="o">=</span> <span class="n">inst</span><span class="p">[</span><span class="n">nodes</span><span class="p">]</span>
        <span class="n">tree</span> <span class="o">=</span> <span class="n">tree</span><span class="p">[</span><span class="n">nodes</span><span class="p">][</span><span class="n">value</span><span class="p">]</span>
        <span class="n">prediction</span> <span class="o">=</span> <span class="mi">0</span>
            
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">dict</span><span class="p">:</span>
            <span class="n">prediction</span> <span class="o">=</span> <span class="n">predict</span><span class="p">(</span><span class="n">inst</span><span class="p">,</span> <span class="n">tree</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">prediction</span> <span class="o">=</span> <span class="n">tree</span>
            <span class="k">break</span><span class="p">;</span>                            
        
    <span class="k">return</span> <span class="n">prediction</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Prediction">Prediction<a class="anchor-link" href="#Prediction"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inst</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>  <span class="c1">#This takes row with index 6</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inst</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Taste          Salty
Temperature     Cold
Texture         Soft
Eat               No
Name: 6, dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can check with our available data.</p>
<p>We took a row with index 6 from our dataframe to use this for our prediction.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Get prediction</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Taste&#39;</span><span class="p">:</span><span class="s1">&#39;Salty&#39;</span><span class="p">,</span> <span class="s1">&#39;Temperature&#39;</span><span class="p">:</span><span class="s1">&#39;Cold&#39;</span><span class="p">,</span> <span class="s1">&#39;Texture&#39;</span><span class="p">:</span><span class="s1">&#39;Hard&#39;</span><span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inst</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">prediction</span> <span class="o">=</span> <span class="n">predict</span><span class="p">(</span><span class="n">inst</span><span class="p">,</span> <span class="n">tree</span><span class="p">)</span>
<span class="n">prediction</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;Yes&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our tree predicted kid will eat this food (which is Salty, Cold and Hard).</p>
<p>This is a simple tree building algorithm without much control parameters.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Some of the contents here, I am inspired from this book ‘Ensemble machine learning-Ankit Dixit’. I encourage you to read it for further explorations.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Below cell is for styling, ignore it.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">HTML</span>
<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="s2">&quot;&lt;style&gt;.container { width:100% !important; }&lt;/style&gt;&quot;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<style>.container { width:100% !important; }</style>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

